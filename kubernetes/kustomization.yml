apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
configurations:
- ./third-party/rollout-transform.yaml

resources:
- adservice.yaml
- cartservice.yaml
- checkoutservice.yaml
- currencyservice.yaml
- emailservice.yaml
- frontend.yaml
- paymentservice.yaml
- productcatalogservice.yaml
- recommendationservice.yaml
- shippingservice.yaml
- redis.yaml

patches:
- path: ./patch-canary.yml
  target:
    group: argoproj.io
    kind: Rollout
    version: v1alpha1
images:
- name: adservice
  newName: gcr.io/gke-demo-1577719075/adservice
- name: cartservice
  newName: gcr.io/gke-demo-1577719075/cartservice
- name: checkoutservice
  newName: gcr.io/gke-demo-1577719075/checkoutservice
- name: currencyservice
  newName: gcr.io/gke-demo-1577719075/currencyservice
- name: emailservice
  newName: gcr.io/gke-demo-1577719075/emailservice
- name: frontend
  newName: gcr.io/gke-demo-1577719075/frontend
- name: paymentservice
  newName: gcr.io/gke-demo-1577719075/paymentservice
- name: productcatalogservice
  newName: gcr.io/gke-demo-1577719075/productcatalogservice
- name: recommendationservice
  newName: gcr.io/gke-demo-1577719075/recommendationservice
- name: shippingservice
  newName: gcr.io/gke-demo-1577719075/shippingservice
